Dropzone.autoDiscover=!1,$(document).ready(function(){let e=$("#board-member-form, #board-member-form-update");if(0===e.length)return;var t=e.data("upload-url");let i=e.data("csrf-token"),r=e.data("csrf-hash"),s=e.data("base-url"),a=new Dropzone("#picture-dropzone",{url:t,paramName:"file",maxFiles:1,acceptedFiles:"image/*",autoProcessQueue:!1,headers:{"X-Requested-With":"XMLHttpRequest"},init:function(){this.on("sending",function(e,t,s){s.append(i,r),s.append("type","picture")}),this.on("success",function(e,t){"success"===t.status&&$("#picture_path").val(t.path)}),this.on("addedfile",function(){null!=this.files[1]&&this.removeFile(this.files[0])}),this.on("queuecomplete",function(){n&&u()});var e,t=$("#picture_path").val();t&&""!==t.trim()&&(this.emit("addedfile",e={name:"Current Picture",size:12345,accepted:!0}),this.emit("thumbnail",e,s+(t.startsWith("/")?t:"/"+t)),this.emit("complete",e),this.files.push(e))}}),o=new Dropzone("#logo-dropzone",{url:t,paramName:"file",maxFiles:1,acceptedFiles:"image/*",autoProcessQueue:!1,headers:{"X-Requested-With":"XMLHttpRequest"},init:function(){this.on("sending",function(e,t,s){s.append(i,r),s.append("type","logo")}),this.on("success",function(e,t){"success"===t.status&&$("#logo_path").val(t.path)}),this.on("addedfile",function(){null!=this.files[1]&&this.removeFile(this.files[0])}),this.on("queuecomplete",function(){n&&c()});var e,t=$("#logo_path").val();t&&""!==t.trim()&&(this.emit("addedfile",e={name:"Current Logo",size:12345,accepted:!0}),this.emit("thumbnail",e,s+(t.startsWith("/")?t:"/"+t)),this.emit("complete",e),this.files.push(e))}}),n=!1;function u(){n&&(0<o.getQueuedFiles().length?o.processQueue():c())}function c(){if(n){let t=$("#submit-btn, #submit-btn-update"),s=-1!==e.attr("action").indexOf("update");t.text(s?"Updating Member...":"Saving Member..."),$.ajax({url:e.attr("action"),method:"POST",data:e.serialize(),dataType:"json",success:function(e){"success"===e.status||1==e.success?(toastr.success(e.message||"Success",e.message_header||"Board Member"),setTimeout(function(){window.location.href=e.redirect},1e3)):(n=!1,t.prop("disabled",!1).text(s?"Update Member":"Save Member"),"object"==typeof e.errors?$.each(e.errors,function(e,t){toastr.error(t,"Validation Error")}):toastr.error(e.message||"An error occurred",e.message_header||"Error"))},error:function(){n=!1,t.prop("disabled",!1).text(s?"Update Member":"Save Member"),toastr.error("An unexpected error occurred.","Error")}})}}$("#submit-btn, #submit-btn-update").on("click",function(e){e.preventDefault();e=$(this);n||(n=!0,e.prop("disabled",!0).text("Processing..."),0<a.getQueuedFiles().length?a.processQueue():u())}),e.on("submit",function(e){e.preventDefault(),n||$("#submit-btn, #submit-btn-update").first().click()})});