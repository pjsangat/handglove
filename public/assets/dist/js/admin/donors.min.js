Dropzone.autoDiscover=!1,$(document).ready(function(){let e=$("#donor-form, #donor-form-update");if(0===e.length)return;var t=e.data("upload-url");let r=e.data("csrf-token"),s=e.data("csrf-hash"),o=e.data("base-url"),n=new Dropzone("#logo-dropzone",{url:t,paramName:"file",maxFiles:1,acceptedFiles:"image/*",autoProcessQueue:!1,headers:{"X-Requested-With":"XMLHttpRequest"},init:function(){this.on("sending",function(e,t,o){o.append(r,s),o.append("type","logo")}),this.on("success",function(e,t){"success"===t.status&&$("#logo_path").val(t.path)}),this.on("addedfile",function(){null!=this.files[1]&&this.removeFile(this.files[0])}),this.on("queuecomplete",function(){a&&i()});var e,t=$("#logo_path").val();t&&""!==t.trim()&&(this.emit("addedfile",e={name:"Current Logo",size:12345,accepted:!0}),this.emit("thumbnail",e,o+(t.startsWith("/")?t:"/"+t)),this.emit("complete",e),this.files.push(e))}}),a=!1;function i(){if(a){let t=$("#submit-btn, #submit-btn-update"),o=-1!==e.attr("action").indexOf("update");t.text(o?"Updating Donor...":"Saving Donor..."),$.ajax({url:e.attr("action"),method:"POST",data:e.serialize(),dataType:"json",success:function(e){"success"===e.status||1==e.success?(toastr.success(e.message||"Success",e.message_header||"Donor"),setTimeout(function(){window.location.href=e.redirect},1e3)):(a=!1,t.prop("disabled",!1).text(o?"Update Donor":"Save Donor"),"object"==typeof e.errors?$.each(e.errors,function(e,t){toastr.error(t,"Validation Error")}):toastr.error(e.message||"An error occurred",e.message_header||"Error"))},error:function(){a=!1,t.prop("disabled",!1).text(o?"Update Donor":"Save Donor"),toastr.error("An unexpected error occurred.","Error")}})}}$("#submit-btn, #submit-btn-update").on("click",function(e){e.preventDefault();e=$(this);a||(a=!0,e.prop("disabled",!0).text("Processing..."),0<n.getQueuedFiles().length?n.processQueue():i())}),e.on("submit",function(e){e.preventDefault(),a||$("#submit-btn, #submit-btn-update").first().click()})});